{
  "SchemaVersion": 2,
  "CreatedAt": "2025-12-21T17:48:34.314303554Z",
  "ArtifactName": "p12-app:local",
  "ArtifactType": "container_image",
  "Metadata": {
    "OS": {
      "Family": "debian",
      "Name": "13.2"
    },
    "ImageID": "sha256:86c9bd8ed8449a25822eab0fe9c14db9c28c7913ab0c130fe5c7bee6f2d2dbee",
    "DiffIDs": [
      "sha256:77a2b55fbe8b9984ce0af3ffc0b0ab62507668e63306ec161a585e587a3eb164",
      "sha256:d3ed01caa08409d7ff04793f0b0dfb39c0d1939740be551109e87f0e62b0a9f0",
      "sha256:644f9c869502a74da62088149065804b8cd717eb2cdb30bf1e59f05361cf4724",
      "sha256:602c1c97924f2a6b937eaa66046c1207e4c3eb26f7c0e66c99cb456fea375715",
      "sha256:69a78cc0a477ae5ed631727e839032d60d1982e824a5c0353dfbe5cdc78016a3",
      "sha256:6a78932cf369fb6108d9f43e6c77a2f1c40fabe5f628841f6d2e8bcfbfdd6fee",
      "sha256:56e88cd101db7341cd653038d8be53f8c87d7b98af4aec176ce92fd7b4fefe67",
      "sha256:75b0fb0aec30489ce0000b4ad4d4f9578f70a21e6d34eef5a23a4f7389b9fe72",
      "sha256:a37ac312f54ca61402f17195c8952f67fb7a7c74f504350d0b67ef7e0a24f69c",
      "sha256:31967d8517f32fbc1396e321ff539ded54e086d475fc20b99e7d05c5f5b48f3b"
    ],
    "RepoTags": [
      "p12-app:local"
    ],
    "ImageConfig": {
      "architecture": "amd64",
      "created": "2025-12-21T17:48:09.923376689Z",
      "history": [
        {
          "created": "2025-12-08T00:00:00Z",
          "created_by": "# debian.sh --arch 'amd64' out/ 'trixie' '@1765152000'",
          "comment": "debuerreotype 0.16"
        },
        {
          "created": "2025-12-08T23:32:45Z",
          "created_by": "ENV PATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-12-08T23:32:45Z",
          "created_by": "ENV LANG=C.UTF-8",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-12-08T23:32:45Z",
          "created_by": "RUN /bin/sh -c set -eux; \tapt-get update; \tapt-get install -y --no-install-recommends \t\tca-certificates \t\tnetbase \t\ttzdata \t; \tapt-get dist-clean # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-12-08T23:32:45Z",
          "created_by": "ENV GPG_KEY=7169605F62C751356D054A26A821E680E5FA6305",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-12-08T23:32:45Z",
          "created_by": "ENV PYTHON_VERSION=3.12.12",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-12-08T23:32:45Z",
          "created_by": "ENV PYTHON_SHA256=fb85a13414b028c49ba18bbd523c2d055a30b56b18b92ce454ea2c51edc656c4",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-12-08T23:40:50Z",
          "created_by": "RUN /bin/sh -c set -eux; \t\tsavedAptMark=\"$(apt-mark showmanual)\"; \tapt-get update; \tapt-get install -y --no-install-recommends \t\tdpkg-dev \t\tgcc \t\tgnupg \t\tlibbluetooth-dev \t\tlibbz2-dev \t\tlibc6-dev \t\tlibdb-dev \t\tlibffi-dev \t\tlibgdbm-dev \t\tliblzma-dev \t\tlibncursesw5-dev \t\tlibreadline-dev \t\tlibsqlite3-dev \t\tlibssl-dev \t\tmake \t\ttk-dev \t\tuuid-dev \t\twget \t\txz-utils \t\tzlib1g-dev \t; \t\twget -O python.tar.xz \"https://www.python.org/ftp/python/${PYTHON_VERSION%%[a-z]*}/Python-$PYTHON_VERSION.tar.xz\"; \techo \"$PYTHON_SHA256 *python.tar.xz\" | sha256sum -c -; \twget -O python.tar.xz.asc \"https://www.python.org/ftp/python/${PYTHON_VERSION%%[a-z]*}/Python-$PYTHON_VERSION.tar.xz.asc\"; \tGNUPGHOME=\"$(mktemp -d)\"; export GNUPGHOME; \tgpg --batch --keyserver hkps://keys.openpgp.org --recv-keys \"$GPG_KEY\"; \tgpg --batch --verify python.tar.xz.asc python.tar.xz; \tgpgconf --kill all; \trm -rf \"$GNUPGHOME\" python.tar.xz.asc; \tmkdir -p /usr/src/python; \ttar --extract --directory /usr/src/python --strip-components=1 --file python.tar.xz; \trm python.tar.xz; \t\tcd /usr/src/python; \tgnuArch=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\"; \t./configure \t\t--build=\"$gnuArch\" \t\t--enable-loadable-sqlite-extensions \t\t--enable-optimizations \t\t--enable-option-checking=fatal \t\t--enable-shared \t\t$(test \"${gnuArch%%-*}\" != 'riscv64' \u0026\u0026 echo '--with-lto') \t\t--with-ensurepip \t; \tnproc=\"$(nproc)\"; \tEXTRA_CFLAGS=\"$(dpkg-buildflags --get CFLAGS)\"; \tLDFLAGS=\"$(dpkg-buildflags --get LDFLAGS)\"; \tLDFLAGS=\"${LDFLAGS:--Wl},--strip-all\"; \t\tarch=\"$(dpkg --print-architecture)\"; arch=\"${arch##*-}\"; \t\tcase \"$arch\" in \t\t\tamd64|arm64) \t\t\t\tEXTRA_CFLAGS=\"${EXTRA_CFLAGS:-} -fno-omit-frame-pointer -mno-omit-leaf-frame-pointer\"; \t\t\t\t;; \t\t\ti386) \t\t\t\t;; \t\t\t*) \t\t\t\tEXTRA_CFLAGS=\"${EXTRA_CFLAGS:-} -fno-omit-frame-pointer\"; \t\t\t\t;; \t\tesac; \tmake -j \"$nproc\" \t\t\"EXTRA_CFLAGS=${EXTRA_CFLAGS:-}\" \t\t\"LDFLAGS=${LDFLAGS:-}\" \t; \trm python; \tmake -j \"$nproc\" \t\t\"EXTRA_CFLAGS=${EXTRA_CFLAGS:-}\" \t\t\"LDFLAGS=${LDFLAGS:--Wl},-rpath='\\$\\$ORIGIN/../lib'\" \t\tpython \t; \tmake install; \t\tcd /; \trm -rf /usr/src/python; \t\tfind /usr/local -depth \t\t\\( \t\t\t\\( -type d -a \\( -name test -o -name tests -o -name idle_test \\) \\) \t\t\t-o \\( -type f -a \\( -name '*.pyc' -o -name '*.pyo' -o -name 'libpython*.a' \\) \\) \t\t\\) -exec rm -rf '{}' + \t; \t\tldconfig; \t\tapt-mark auto '.*' \u003e /dev/null; \tapt-mark manual $savedAptMark; \tfind /usr/local -type f -executable -not \\( -name '*tkinter*' \\) -exec ldd '{}' ';' \t\t| awk '/=\u003e/ { so = $(NF-1); if (index(so, \"/usr/local/\") == 1) { next }; gsub(\"^/(usr/)?\", \"\", so); printf \"*%s\\n\", so }' \t\t| sort -u \t\t| xargs -rt dpkg-query --search \t\t| awk 'sub(\":$\", \"\", $1) { print $1 }' \t\t| sort -u \t\t| xargs -r apt-mark manual \t; \tapt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false; \tapt-get dist-clean; \t\texport PYTHONDONTWRITEBYTECODE=1; \tpython3 --version; \tpip3 --version # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-12-08T23:40:51Z",
          "created_by": "RUN /bin/sh -c set -eux; \tfor src in idle3 pip3 pydoc3 python3 python3-config; do \t\tdst=\"$(echo \"$src\" | tr -d 3)\"; \t\t[ -s \"/usr/local/bin/$src\" ]; \t\t[ ! -e \"/usr/local/bin/$dst\" ]; \t\tln -svT \"$src\" \"/usr/local/bin/$dst\"; \tdone # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-12-08T23:40:51Z",
          "created_by": "CMD [\"python3\"]",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-12-21T17:48:00Z",
          "created_by": "ENV PYTHONUNBUFFERED=1 PYTHONDONTWRITEBYTECODE=1",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-12-21T17:48:00Z",
          "created_by": "WORKDIR /app",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-12-21T17:48:00Z",
          "created_by": "RUN /bin/sh -c groupadd -r app \u0026\u0026 useradd -r -g app app # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-12-21T17:48:06Z",
          "created_by": "COPY /wheels /wheels # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-12-21T17:48:09Z",
          "created_by": "RUN /bin/sh -c pip install --no-cache-dir /wheels/* \u0026\u0026     rm -rf /wheels # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-12-21T17:48:09Z",
          "created_by": "COPY --chown=app:app . . # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-12-21T17:48:09Z",
          "created_by": "RUN /bin/sh -c mkdir -p /app/db \u0026\u0026 chown -R app:app /app/db # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-12-21T17:48:09Z",
          "created_by": "USER app",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-12-21T17:48:09Z",
          "created_by": "HEALTHCHECK \u0026{[\"CMD-SHELL\" \"curl -f http://localhost:8000/health || exit 1\"] \"30s\" \"5s\" \"10s\" \"0s\" '\\x03'}",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-12-21T17:48:09Z",
          "created_by": "EXPOSE map[8000/tcp:{}]",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-12-21T17:48:09Z",
          "created_by": "CMD [\"uvicorn\" \"app.main:app\" \"--host\" \"0.0.0.0\" \"--port\" \"8000\"]",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        }
      ],
      "os": "linux",
      "rootfs": {
        "type": "layers",
        "diff_ids": [
          "sha256:77a2b55fbe8b9984ce0af3ffc0b0ab62507668e63306ec161a585e587a3eb164",
          "sha256:d3ed01caa08409d7ff04793f0b0dfb39c0d1939740be551109e87f0e62b0a9f0",
          "sha256:644f9c869502a74da62088149065804b8cd717eb2cdb30bf1e59f05361cf4724",
          "sha256:602c1c97924f2a6b937eaa66046c1207e4c3eb26f7c0e66c99cb456fea375715",
          "sha256:69a78cc0a477ae5ed631727e839032d60d1982e824a5c0353dfbe5cdc78016a3",
          "sha256:6a78932cf369fb6108d9f43e6c77a2f1c40fabe5f628841f6d2e8bcfbfdd6fee",
          "sha256:56e88cd101db7341cd653038d8be53f8c87d7b98af4aec176ce92fd7b4fefe67",
          "sha256:75b0fb0aec30489ce0000b4ad4d4f9578f70a21e6d34eef5a23a4f7389b9fe72",
          "sha256:a37ac312f54ca61402f17195c8952f67fb7a7c74f504350d0b67ef7e0a24f69c",
          "sha256:31967d8517f32fbc1396e321ff539ded54e086d475fc20b99e7d05c5f5b48f3b"
        ]
      },
      "config": {
        "Cmd": [
          "uvicorn",
          "app.main:app",
          "--host",
          "0.0.0.0",
          "--port",
          "8000"
        ],
        "Healthcheck": {
          "Test": [
            "CMD-SHELL",
            "curl -f http://localhost:8000/health || exit 1"
          ],
          "Interval": 30000000000,
          "Timeout": 5000000000,
          "StartPeriod": 10000000000,
          "Retries": 3
        },
        "Env": [
          "PATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
          "LANG=C.UTF-8",
          "GPG_KEY=7169605F62C751356D054A26A821E680E5FA6305",
          "PYTHON_VERSION=3.12.12",
          "PYTHON_SHA256=fb85a13414b028c49ba18bbd523c2d055a30b56b18b92ce454ea2c51edc656c4",
          "PYTHONUNBUFFERED=1",
          "PYTHONDONTWRITEBYTECODE=1"
        ],
        "User": "app",
        "WorkingDir": "/app",
        "ArgsEscaped": true
      }
    }
  },
  "Results": [
    {
      "Target": "p12-app:local (debian 13.2)",
      "Class": "os-pkgs",
      "Type": "debian"
    },
    {
      "Target": "Python",
      "Class": "lang-pkgs",
      "Type": "python-pkg",
      "Vulnerabilities": [
        {
          "VulnerabilityID": "CVE-2024-47874",
          "PkgName": "starlette",
          "PkgPath": "usr/local/lib/python3.12/site-packages/starlette-0.38.6.dist-info/METADATA",
          "PkgIdentifier": {
            "PURL": "pkg:pypi/starlette@0.38.6",
            "UID": "2922538082d95660"
          },
          "InstalledVersion": "0.38.6",
          "FixedVersion": "0.40.0",
          "Status": "fixed",
          "Layer": {
            "DiffID": "sha256:75b0fb0aec30489ce0000b4ad4d4f9578f70a21e6d34eef5a23a4f7389b9fe72"
          },
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-47874",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory pip",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"
          },
          "Title": "starlette: Starlette Denial of service (DoS) via multipart/form-data",
          "Description": "Starlette is an Asynchronous Server Gateway Interface (ASGI) framework/toolkit. Prior to version 0.40.0, Starlette treats `multipart/form-data` parts without a `filename` as text form fields and buffers those in byte strings with no size limit. This allows an attacker to upload arbitrary large form fields and cause Starlette to both slow down significantly due to excessive memory allocations and copy operations, and also consume more and more memory until the server starts swapping and grinds to a halt, or the OS terminates the server process with an OOM error. Uploading multiple such requests in parallel may be enough to render a service practically unusable, even if reasonable request size limits are enforced by a reverse proxy in front of Starlette. This Denial of service (DoS) vulnerability affects all applications built with Starlette (or FastAPI) accepting form requests. Verison 0.40.0 fixes this issue.",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-770"
          ],
          "VendorSeverity": {
            "ghsa": 3,
            "redhat": 3
          },
          "CVSS": {
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-47874",
            "https://github.com/encode/starlette",
            "https://github.com/encode/starlette/commit/fd038f3070c302bff17ef7d173dbb0b007617733",
            "https://github.com/encode/starlette/security/advisories/GHSA-f96h-pmfr-66vw",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-47874",
            "https://www.cve.org/CVERecord?id=CVE-2024-47874"
          ],
          "PublishedDate": "2024-10-15T16:15:05.26Z",
          "LastModifiedDate": "2024-11-21T17:15:17.99Z"
        }
      ]
    }
  ]
}
